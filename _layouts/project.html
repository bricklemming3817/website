<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <title>{{ page.title }}</title>
    <style>
      :root {
        --accent: #0055ff;
        --background: #fff;
        --foreground: #000;
        --border: #ddd;
      }
      .dark {
        --background: #000;
        --foreground: #fff;
        --border: #333;
      }
      html { scroll-behavior: smooth; }
      body {
        margin: 0;
        font-family: system-ui, sans-serif;
        background: var(--background);
        color: var(--foreground);
        line-height: 1.5;
      }
      header {
        position: sticky;
        top: 0;
        z-index: 10;
        background: var(--background);
        border-bottom: 1px solid var(--border);
        padding: 0.5rem 1rem;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      header nav { display: flex; gap: 1rem; }
      header a { text-decoration: none; color: inherit; padding: 0.25rem 0.5rem; }
      header a:hover, header a:focus { color: var(--accent); }
      .theme-toggle {
        position: absolute;
        left: 1rem;
        background: none;
        border: 1px solid var(--border);
        border-radius: 4px;
        padding: 0.25rem 0.5rem;
        cursor: pointer;
        color: inherit;
      }
      main { max-width: 800px; margin: 0 auto; padding: 2rem 1rem 4rem; }
      h1 { font-size: 2rem; margin-top: 1rem; }
      .chips { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0 1rem; }
      .chip { border: 1px solid var(--border); border-radius: 999px; padding: 0.25rem 0.75rem; font-size: 0.875rem; }
      footer { padding: 4rem 1rem; text-align: center; border-top: 1px solid var(--border); }
      .meta { color: #666; font-size: 0.9rem; }
      .hero-img { width: 100%; height: auto; border: 1px solid var(--border); margin: 1rem 0; }
      a { color: inherit; }
      a:hover, a:focus { color: var(--accent); }
    </style>
  </head>
  <body>
    <main>
      <h1>{{ page.title }}</h1>
      {% if page.tags %}
      <div class="chips">
        {% for tag in page.tags %}<span class="chip">{{ tag }}</span>{% endfor %}
      </div>
      {% endif %}

      {% if page.image %}
        <img class="hero-img" src="{{ page.image }}" alt="{{ page.image_alt | default: page.title }}" />
      {% endif %}

      {% if page.summary %}<p class="meta">{{ page.summary }}</p>{% endif %}

      {% if page.purpose or page.why or page.approach or page.outcome or page.reflection %}
        <section>
          {% if page.purpose %}<p><strong>Purpose:</strong> {{ page.purpose }}</p>{% endif %}
          {% if page.why %}<p><strong>Why:</strong> {{ page.why }}</p>{% endif %}
          {% if page.approach %}<p><strong>Approach:</strong> {{ page.approach }}</p>{% endif %}
          {% if page.outcome %}<p><strong>Outcome:</strong> {{ page.outcome }}</p>{% endif %}
          {% if page.reflection %}<p><strong>Reflection:</strong> {{ page.reflection }}</p>{% endif %}
        </section>
      {% endif %}

      <article>
        {{ content }}
      </article>
    </main>
    <footer>
      <small><a href="{{ '/' | relative_url }}">Back to home</a></small>
    </footer>
    <script>
      const toggle = document.getElementById("theme-toggle");
      const root = document.documentElement;
      const stored = localStorage.getItem("theme");
      if (stored === "dark" || (!stored && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
        root.classList.add("dark");
      }
      if (toggle) {
        toggle.addEventListener("click", () => {
          root.classList.toggle("dark");
          const theme = root.classList.contains("dark") ? "dark" : "light";
          localStorage.setItem("theme", theme);
        });
      }
    </script>
  </body>
  </html>
